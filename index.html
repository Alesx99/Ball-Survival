<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ball Survival - Archetipi</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="gameContainer">
        <div id="menuOverlay"></div>
        <canvas id="gameCanvas"></canvas>
        <div id="joystick-container"><div id="joystick-stick"></div></div>
        <div id="pauseButton">||</div>
        <button id="pauseButtonMobile" style="display:none; position:fixed; top:12px; right:12px; z-index:1002; font-size:22px; padding:10px 18px; border-radius:50%; background:#4a90e2; color:#fff; border:none; box-shadow:0 2px 8px #0005;">‚è∏</button>

        <!-- NUOVA UI DI GIOCO -->
        <div id="inGameUI">
            <div id="gameTimer">0s</div>
            <div id="xpBarContainer">
                <div id="xpBarFill"></div>
                <div id="xpBarText">LVL 1</div>
            </div>
            <div id="gemCounter">üíé 0</div>
        </div>

        <!-- Popups -->
        <div id="startScreen" class="popup-menu">
            <h2>‚öΩ Ball Survival - Archetipi</h2>
            <p>Sopravvivi il pi√π a lungo possibile!</p>
            <div class="controls">
                <p><strong>Controlli:</strong> Joystick (Mobile), WASD/Frecce (PC), E/Tocca (Negozio), ESC/Pausa</p>
            </div>
            
            <h4 style="text-align: center; color: var(--secondary-color); margin-bottom: 10px; margin-top: 20px;">Scegli la tua Sfera:</h4>
            <div id="characterSelectionContainer" class="menu-content"></div>

            <div class="menu-actions">
                <button id="startGameBtn">Inizia Partita</button>
            </div>
            <div class="save-load-container">
                <p>Carica i tuoi progressi:</p>
                <input type="text" id="loadCodeInput" placeholder="Incolla il codice di salvataggio...">
                <button id="loadGameBtn">Carica</button>
                <div id="load-notification"></div>
            </div>
        </div>
        <div id="upgradeMenu" class="popup-menu">
            <h3>Scegli un Potenziamento!</h3>
            <div id="upgradeOptions" class="menu-content"></div>
        </div>
        <div id="pauseMenu" class="popup-menu">
            <h2>Pausa</h2>
            <div id="runStatsContainer"></div>
            <div id="pauseStatsContainer" class="menu-content">
                <div id="playerStatsColumn" class="stats-column"></div>
                <div id="weaponsStatsColumn" class="stats-column"></div>
            </div>
            <div class="menu-actions">
                <button id="restartFromPauseBtn">Riavvia</button>
                <button id="returnToMenuPauseBtn">Torna al Men√π</button>
            </div>
            <button id="generateDebugSave">Genera Codice Parziale</button>
            <div id="debugSaveContainer" class="save-load-container mt-4" style="display: none;">
                 <p>Copia il codice per testare questo scenario:</p>
                <textarea id="debugSaveOutput" readonly></textarea>
                <button id="copyDebugCodeBtn" class="mt-2 w-full">Copia Codice Debug</button>
            </div>
        </div>
        <div id="gameOver" class="popup-menu">
            <h2>Game Over!</h2>
            <p>Sei sopravvissuto per <span id="survivalTime">0</span> secondi</p>
            <p>Nemici sconfitti: <span id="enemiesKilled">0</span></p>
            <p>Cristalli raccolti: <span id="gemsEarned">0</span></p>
            <p>Punteggio Finale: <span id="finalScore">0</span></p>
            <div class="save-load-container">
                 <p>Copia il codice per salvare i tuoi progressi:</p>
                <input type="text" id="saveCodeOutput" readonly>
                <button id="copyCodeBtn">Copia</button>
            </div>
            <div class="menu-actions">
                <button id="restartGameBtn">Riprova</button>
                <button id="returnToMenuBtn">Torna al Men√π</button>
            </div>
        </div>
        <div id="permanentUpgradeShop" class="popup-menu">
            <h3>Negozio Permanente</h3>
            <p>I tuoi cristalli: <span id="totalGemsShop">0</span> üíé</p>
            <div id="permanentUpgradeOptions" class="menu-content"></div>
        </div>
    </div>

    <script src="game.js"></script>
</body>
</html>
